<odoo>
    <record id="view_warehouse_extend_unified_grouped" model="ir.ui.view">
        <field name="name">stock.warehouse.form.l10n.pe.edi.address.pos.invoice.journals.unified.grouped</field>
        <field name="model">stock.warehouse</field>
        <field name="inherit_id" ref="stock.view_warehouse"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']/.." position="inside">
                <field name="l10n_pe_edi_address_type_code"/>
                <field name="pos_invoice_journal_ids" widget="many2many_tags" domain="[('company_id', '=', company_id), ('type', '=', 'sale')]" context="{'default_company_id': company_id, 'default_type': 'sale'}"/>
                <field name="default_partner_id"/>
            </xpath>
        </field>
    </record>
    <record id="view_move_form_with_warehouse_id_reference" model="ir.ui.view">
        <field name="name">account.move.warehouse</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@id='header_right_group']//label[@for='journal_id']" position="before">
                <label for="warehouse_id"/>
            
                <div name="warehouse_id_div" class="d-flex">
                    <field name="warehouse_id" 
                       options="{'no_create': True}" 
                       attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                </div>
            </xpath>
        </field>
    </record>
    <record id="view_move_form_restrict_journal_by_warehouse" model="ir.ui.view">
        <field name="name">account.move.journal.restriction</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='journal_id']" position="attributes">
                <attribute name="domain">[('id', 'in', allowed_journal_ids)]</attribute>
            </xpath>
        
            <xpath expr="//field[@name='warehouse_id']" position="attributes">
                <attribute name="on_change">1</attribute>
            </xpath>
    </field>
</record>
</odoo>
